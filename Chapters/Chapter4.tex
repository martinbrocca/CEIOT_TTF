% Chapter Template

\chapter{Ensayos y resultados} % Main chapter title

\label{Chapter4} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

%----------------------------------------------------------------------------------------
%	SECTION 1
%----------------------------------------------------------------------------------------
En este capítulo se explica la metodología de pruebas aplicada tanto a los componentes individuales como al sistema implementado para finalizar con una comparación con el estado del arte.


\section{Banco de pruebas}
\label{sec:Banco de pruebas}
%
La verificación del correcto funcionamiento de los módulos que componen el sistema se realizó mediante una maqueta que se muestra en la figura \ref{fig:maqueta} y representa en escala reducida al invernadero del cliente.

El modelo cuenta con una bomba de agua conectada a tres válvulas para alimentar a los circuitos de riego. 
Se utilizaron mangueras y conexiones neumáticas de aluminio de acople rápido y el conjunto armado puede verse en la figura \ref{fig:pump}. 
  
El ensamblado se muestra en las figuras \ref{fig:gh1}, \ref{fig:gh2} y \ref{fig:gh3} donde se observa la implementación de dos circuitos de riego independientes. También se configuró un tercer circuito cerrado para pruebas de accionamiento de bomba y válvula a fin de evitar desperdicios durante las fases de calibración.


\begin{figure}[h]
	\centering
	\includegraphics[width=0.50\textwidth]{./Figures/chapter4/maqueta.jpg}
	\caption[Modelo completo del invernadero]{Modelo completo del invernadero.}
	\label{fig:maqueta}
\end{figure}

Además se incorporaron a la maqueta dos módulos sensores de humedad del suelo, uno de temperatura y humedad y un actuador para el encendido de los ventiladores.

Para las pruebas manuales de accionamiento de los diferentes sistemas se empleó una computadora portátil y un celular para las pruebas de acceso concurrente a la aplicación central.

\begin{figure}[htpb]
     \centering
       \begin{subfigure}[b]{0.45\textwidth}
	    \centering
		 \includegraphics[width=0.75\textwidth]{./Figures/chapter4/pump_2.jpg}
		\caption{Conjunto bomba y válvulas.}
		\label{fig:pump}
     \end{subfigure}
          \hfill
     \begin{subfigure}[b]{0.45\textwidth}
		\centering
		\includegraphics[width=0.70\textwidth]{./Figures/chapter4/Invernadero1.jpg}
		\caption{Armado de mangueras de riego.}
		\label{fig:gh1}
     \end{subfigure}
     \hfill
     \begin{subfigure}[b]{0.45\textwidth}
	    \centering
		 \includegraphics[width=0.75\textwidth]{./Figures/chapter4/Invernadero2.jpg}
		\caption{Pruebas de riego.}
		\label{fig:gh2}
     \end{subfigure}
     \hfill	
	 \begin{subfigure}[b]{0.45\textwidth}
		\centering
		\includegraphics[width=0.65\textwidth]{./Figures/chapter4/Invernadero3.jpg}
		\caption{Ensamble general.}
		\label{fig:gh3}
     \end{subfigure}
     \hfill

        \caption[Modelo de pruebas del invernadero]{Modelo de pruebas del invernadero.}
        \label{fig:invernadero}
\end{figure}



\pagebreak
\section{Pruebas individuales}
\label{sec:Pruebas individuales}

Se detallan las principales pruebas realizadas a los módulos a fin de garantizar su correcto funcionamiento y/o el cumplimiento de requerimientos.


\subsection{Pruebas a módulos sensores}
\label{sec:Pruebas a módulos sensores}

\begin{itemize}
\item Conexión a los sensores y valores obtenidos: Se conectaron individualmente los módulos a la computadora mediante la consola serial de Arduino IDE y se constataron los valores obtenidos frente a cambios inducidos sobre la magnitud a medir.

\item Resistencia al agua y a salpicaduras: Requerimiento no funcional explícito para los sensores de humedad del suelo. Consistió en comprobar la integridad y el funcionamiento del módulo al tiempo que se sumergía el sensor en un recipiente con agua o se lo sometía a aspersiones continuas por alrededor de 30 segundos con atomizadores desde diferentes ángulos.
La figura \ref{fig:soil_test} esquematiza parcialmente el proceso de prueba mencionado.

  
\end{itemize}


\begin{figure}[h]
	\centering
	\includegraphics[width=0.50\textwidth]{./Figures/chapter4/soil_testing3.jpg}
	\caption[Prueba de resistencia al agua]{Prueba de resistencia al agua.}
	\label{fig:soil_test}
\end{figure}

\subsection{Pruebas a módulos actuadores}
\label{sec:Pruebas a módulos actuadores}

Se conectaron las salidas de los pines de GPIO a leds para visualizar el encendido y apagado del actuador. 
A fin de enviar las señales de comando se desarrolló una interfaz simple en ThingsBoard que envía mensajes RPC sobre MQTT al módulo. El microcontrolador recibe la orden y ejecuta la acción, reflejada en el estado de los leds correspondientes.



\begin{figure}[htpb]
     \centering
       \begin{subfigure}[b]{0.50\textwidth}
	    \centering
		 \includegraphics[width=0.9\textwidth]{./Figures/chapter4/control_unit_test_1.jpg}
		\caption{Ventana de control.}
		\label{fig:control_test1}
     \end{subfigure}
          \hfill
     \begin{subfigure}[b]{0.45\textwidth}
		\centering
		\includegraphics[width=0.70\textwidth]{./Figures/chapter4/control_test2.jpg}
		\caption{Verificación del actuador mediante leds.}
		\label{fig:control_test2}
     \end{subfigure}
     \hfill
        \caption[Pruebas unitarias sobre controladores]{Pruebas unitarias sobre controladores.}
        \label{fig:control_test}
\end{figure}


\subsection{Pruebas de acceso concurrente a la aplicación}
\label{sec:Pruebas de acceso concurrente a la aplicación}



Las pruebas de concurrencia se realizaron mediante el acceso simultáneo de diferentes usuarios mediante una computadora portátil y un teléfono celular. Los ensayos consistieron en realizar diferentes acciones desde un dispositivo como, por ejemplo, el accionamiento de un circuito de riego por parte de un usuario, y la confirmación del cambio de estado recibida por otro. 
 
La figura \ref{fig:tb_compu} muestra la vista obtenida mediante el uso del ordernador mientras que la figura  \ref{fig:tb_celu} la del celular.

\begin{figure}[htpb]
     \centering
       \begin{subfigure}[b]{0.53\textwidth}
	    \centering
		 \includegraphics[width=0.9\textwidth]{./Figures/chapter4/tb_compu.jpg}
		\caption{Vista sobre acceso por computadora.}
		\label{fig:tb_compu}
     \end{subfigure}
          \hfill
     \begin{subfigure}[b]{0.45\textwidth}
		\centering
		\includegraphics[width=0.40\textwidth]{./Figures/chapter4/tb_celu.jpg}
		\caption{Vista sobre acceso por teléfono celular.}
		\label{fig:tb_celu}
     \end{subfigure}
     \hfill
        \caption[Pruebas unitarias sobre acceso concurrente]{Pruebas unitarias sobre acceso concurrente.}
        \label{fig:tb_concurrencia}
\end{figure}

\section{Pruebas de sistema}
\label{sec:Pruebas de sistema}

\textcolor{gray} {Aquí se describen las pruebas de sistema en donde interactúan dos o más componentes}


\section{Comparativa con el estado de arte}
\label{sec:Comparativa con el estado de arte}

\textcolor{gray} {Aquí se describe la comparación entre el modelo armado y lo informado en el capítulo 1}